# Dot Plate Generator 基本設計書

## 📘 概要

**Dot Plate Generator** は、ピクセルアート（ドット絵）画像をもとに、色ごとの凹み構造を持つ3Dプレートを生成し、STL形式で出力できるGUIアプリケーションです。主に **レジンアート・3Dプリント用マスクプレート**を自動で作成する目的で開発されました。

---

## 🎯 目的・背景

### 課題
- ドット絵を3Dプリンタ用の立体構造に変換するには手作業でのモデリングが必要で煩雑
- 凹み部分や色分割など、**形状処理のルール化**が求められる

### 目的
- 任意のドット絵を自動解析し、**ドットごとの凹み構造プレート**を生成
- STLとして出力し、3Dプリントやレジン流し込みに活用可能な形にする
- プレビューやパラメータ変更を視覚的に行える**GUIアプリケーション**として提供する

---

## 🧩 機能一覧

| 機能            | 内容 |
|-----------------|------|
| 画像入力         | PNG/JPGなどの画像を読み込み、32×32などにリサイズ |
| 色数自動調整     | 使用色を制限し、減色（step）＋類似色でマッピング |
| マスク抽出       | 透過または黒背景を除いた形状のみを抽出 |
| STL出力         | ドットごとに凹みと壁を生成し、合成してSTL保存 |
| リアルタイム画像プレビュー | パラメータ変更時に再描画されるドットプレビュー |
| STL画像プレビュー | 出力後に `matplotlib` による3Dモデル画像表示 |

---

## ⚙️ パラメータ設定

GUIで操作できるパラメータは以下の通り：

| パラメータ名        | 型     | 範囲      | 初期値 | 説明 |
|---------------------|--------|-----------|--------|------|
| Grid Size           | int    | 8〜64      | 32     | ドット絵変換後のグリッド解像度 |
| Dot Size            | float  | 0.2〜5.0   | 1.0    | 1ドットの物理サイズ（mm） |
| Wall Thickness      | float  | 0.0〜5.0   | 0.2    | 凹みを囲う壁の太さ |
| Wall Height         | float  | 0.0〜5.0   | 1.0    | 凹みを囲う壁の高さ |
| Base Height         | float  | 0.0〜5.0   | 2.0    | プレート自体の厚さ |
| Color Step          | int    | 1〜64      | 8      | 色のstep単位正規化（似た色を統一） |
| Top Colors          | int    | 1〜64      | 36     | 使用する上位色数制限（クラスタ化に近い） |

---

## 🖥 GUI構成

| レイアウト位置 | 内容 |
|----------------|------|
| 左側パネル      | - ドットプレビュー画像（リサイズ＆減色結果）<br>- STLモデルの画像プレビュー（matplotlib描画） |
| 右側パネル      | - 入力画像ファイル名<br>- パラメータ設定欄（スライダー/スピンボックス）<br>- 「画像選択」ボタン<br>- 「STL出力」ボタン |

---

## 🧪 使用ライブラリ

- **PyQt5**：GUI構築
- **PIL (Pillow)**：画像読み込み・縮小・描画
- **numpy**：配列処理
- **trimesh**：STL生成・結合・出力
- **scikit-image**：画像の輪郭抽出（未使用だが将来拡張用）
- **shapely**：マスク領域をポリゴン処理（高度な輪郭対応可）
- **matplotlib**：3D STLを静的に画像化してプレビュー表示

---

## 📂 ファイル構成（推奨）
dot_plate_generator/
 ├── dot_plate_generator_gui.py 
 ├── sample_images/ 
 │ └── elf.png 
 ├── output/ 
 │ └── result.stl 
 └── README.md

 ## 🚀 起動方法

```bash
pip install PyQt5 Pillow numpy trimesh shapely scikit-image matplotlib
python dot_plate_generator_gui.py